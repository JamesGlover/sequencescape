<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>
  Module: Qcable::Statemachine
  
    &mdash; Documentation by YARD 0.9.5
  
</title>

  <link rel="stylesheet" href="../css/style.css" type="text/css" charset="utf-8" />

  <link rel="stylesheet" href="../css/common.css" type="text/css" charset="utf-8" />

<script type="text/javascript" charset="utf-8">
  pathId = "Qcable::Statemachine";
  relpath = '../';
</script>


  <script type="text/javascript" charset="utf-8" src="../js/jquery.js"></script>

  <script type="text/javascript" charset="utf-8" src="../js/app.js"></script>


  </head>
  <body>
    <div class="nav_wrap">
      <iframe id="nav" src="../class_list.html"></iframe>
      <div id="resizer"></div>
    </div>

    <div id="main" tabindex="-1">
      <div id="header">
        <div id="menu">
  
    <a href="../_index.html">Index (S)</a> &raquo;
    <span class='title'><span class='object_link'><a href="../Qcable.html" title="Qcable (class)">Qcable</a></span></span>
     &raquo; 
    <span class="title">Statemachine</span>
  
</div>

        <div id="search">
  
    <a class="full_list_link" id="class_list_link"
        href="../class_list.html">

        <svg width="24" height="24">
          <rect x="0" y="4" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="12" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="20" width="24" height="4" rx="1" ry="1"></rect>
        </svg>
    </a>
  
</div>
        <div class="clear"></div>
      </div>

      <iframe id="search_frame" src="../class_list.html"></iframe>

      <div id="content"><h1>Module: Qcable::Statemachine
  
  
  
</h1>
<div class="box_info">
  

  
  
  
  
  

  
  <dl>
    <dt>Included in:</dt>
    <dd><span class='object_link'><a href="../Qcable.html" title="Qcable (class)">Qcable</a></span></dd>
  </dl>
  

  
  <dl>
    <dt>Defined in:</dt>
    <dd>app/models/qcable/statemachine.rb</dd>
  </dl>
  
</div>

<h2>Overview</h2><div class="docstring">
  <div class="discussion">
    
<p>This file is part of SEQUENCESCAPE; it is distributed under the terms of
GNU General Public License version 1 or later; Please refer to the LICENSE
and README files for information on licensing and authorship of this file.
Copyright (C) 2014,2015 Genome Research Ltd.</p>


  </div>
</div>
<div class="tags">
  

</div><h2>Defined Under Namespace</h2>
<p class="children">
  
    
      <strong class="modules">Modules:</strong> <span class='object_link'><a href="Statemachine/ClassMethods.html" title="Qcable::Statemachine::ClassMethods (module)">ClassMethods</a></span>
    
  
    
  
</p>







  
    <h2>
      Class Method Summary
      <small><a href="#" class="summary_toggle">collapse</a></small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#included-class_method" title="included (class method)">.<strong>included</strong>(base)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
    </ul>
  
    <h2>
      Instance Method Summary
      <small><a href="#" class="summary_toggle">collapse</a></small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#default_state-instance_method" title="#default_state (instance method)">#<strong>default_state</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#on_destroyed-instance_method" title="#on_destroyed (instance method)">#<strong>on_destroyed</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#on_failed-instance_method" title="#on_failed (instance method)">#<strong>on_failed</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#on_passed-instance_method" title="#on_passed (instance method)">#<strong>on_passed</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#on_qc-instance_method" title="#on_qc (instance method)">#<strong>on_qc</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#on_released-instance_method" title="#on_released (instance method)">#<strong>on_released</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#on_stamp-instance_method" title="#on_stamp (instance method)">#<strong>on_stamp</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>â€“ These are the callbacks that will be made on entry to a given state.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#on_used-instance_method" title="#on_used (instance method)">#<strong>on_used</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#transition_to-instance_method" title="#transition_to (instance method)">#<strong>transition_to</strong>(target_state)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
    </ul>
  



  <div id="class_method_details" class="method_details_list">
    <h2>Class Method Details</h2>

    
      <div class="method_details first">
  <h3 class="signature first" id="included-class_method">
  
    .<strong>included</strong>(base)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/qcable/statemachine.rb', line 21</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_included'>included</span><span class='lparen'>(</span><span class='id identifier rubyid_base'>base</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_base'>base</span><span class='period'>.</span><span class='id identifier rubyid_class_eval'>class_eval</span> <span class='kw'>do</span>
    <span class='id identifier rubyid_extend'>extend</span> <span class='const'>ClassMethods</span>

    <span class='comment'>## State machine
</span>    <span class='comment'>## namespace: true as destroyed clashes with rails, but we can&#39;t easily rename the state
</span>    <span class='id identifier rubyid_aasm'>aasm</span> <span class='label'>column:</span> <span class='symbol'>:state</span><span class='comma'>,</span> <span class='label'>whiny_persistence:</span> <span class='kw'>true</span><span class='comma'>,</span> <span class='label'>namespace:</span> <span class='kw'>true</span><span class='comma'>,</span> <span class='label'>name:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>qc_state</span><span class='tstring_end'>&#39;</span></span> <span class='kw'>do</span>
      <span class='id identifier rubyid_state'>state</span> <span class='symbol'>:created</span>
      <span class='id identifier rubyid_state'>state</span> <span class='symbol'>:pending</span><span class='comma'>,</span>        <span class='label'>enter:</span> <span class='symbol'>:on_stamp</span>
      <span class='id identifier rubyid_state'>state</span> <span class='symbol'>:failed</span><span class='comma'>,</span>         <span class='label'>enter:</span> <span class='symbol'>:on_failed</span>
      <span class='id identifier rubyid_state'>state</span> <span class='symbol'>:passed</span><span class='comma'>,</span>         <span class='label'>enter:</span> <span class='symbol'>:on_passed</span>
      <span class='id identifier rubyid_state'>state</span> <span class='symbol'>:available</span><span class='comma'>,</span>      <span class='label'>enter:</span> <span class='symbol'>:on_released</span>
      <span class='id identifier rubyid_state'>state</span> <span class='symbol'>:destroyed</span><span class='comma'>,</span>      <span class='label'>enter:</span> <span class='symbol'>:on_destroyed</span>
      <span class='id identifier rubyid_state'>state</span> <span class='symbol'>:qc_in_progress</span><span class='comma'>,</span> <span class='label'>enter:</span> <span class='symbol'>:on_qc</span>
      <span class='id identifier rubyid_state'>state</span> <span class='symbol'>:exhausted</span><span class='comma'>,</span>      <span class='label'>enter:</span> <span class='symbol'>:on_used</span>

      <span class='id identifier rubyid_initial_state'>initial_state</span> <span class='const'>Proc</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_qcable'>qcable</span><span class='op'>|</span> <span class='id identifier rubyid_qcable'>qcable</span><span class='period'>.</span><span class='id identifier rubyid_default_state'>default_state</span> <span class='rbrace'>}</span>

      <span class='comment'># State Machine events
</span>      <span class='id identifier rubyid_event'>event</span> <span class='symbol'>:do_stamp</span> <span class='kw'>do</span>
        <span class='id identifier rubyid_transitions'>transitions</span> <span class='label'>to:</span> <span class='symbol'>:pending</span><span class='comma'>,</span> <span class='label'>from:</span> <span class='lbracket'>[</span><span class='symbol'>:created</span><span class='rbracket'>]</span>
      <span class='kw'>end</span>

      <span class='id identifier rubyid_event'>event</span> <span class='symbol'>:destroy_labware</span> <span class='kw'>do</span>
        <span class='id identifier rubyid_transitions'>transitions</span> <span class='label'>to:</span> <span class='symbol'>:destroyed</span><span class='comma'>,</span> <span class='label'>from:</span> <span class='lbracket'>[</span><span class='symbol'>:pending</span><span class='comma'>,</span> <span class='symbol'>:available</span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='label'>allow_automated?:</span> <span class='kw'>true</span>
      <span class='kw'>end</span>

      <span class='id identifier rubyid_event'>event</span> <span class='symbol'>:qc</span> <span class='kw'>do</span>
        <span class='id identifier rubyid_transitions'>transitions</span> <span class='label'>to:</span> <span class='symbol'>:qc_in_progress</span><span class='comma'>,</span> <span class='label'>from:</span> <span class='lbracket'>[</span><span class='symbol'>:pending</span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='label'>allow_automated?:</span> <span class='kw'>true</span>
      <span class='kw'>end</span>

      <span class='id identifier rubyid_event'>event</span> <span class='symbol'>:release</span> <span class='kw'>do</span>
        <span class='id identifier rubyid_transitions'>transitions</span> <span class='label'>to:</span> <span class='symbol'>:available</span><span class='comma'>,</span> <span class='label'>from:</span> <span class='lbracket'>[</span><span class='symbol'>:pending</span><span class='rbracket'>]</span>
      <span class='kw'>end</span>

      <span class='id identifier rubyid_event'>event</span> <span class='symbol'>:pass</span> <span class='kw'>do</span>
        <span class='id identifier rubyid_transitions'>transitions</span> <span class='label'>to:</span> <span class='symbol'>:passed</span><span class='comma'>,</span> <span class='label'>from:</span> <span class='lbracket'>[</span><span class='symbol'>:qc_in_progress</span><span class='rbracket'>]</span>
      <span class='kw'>end</span>

      <span class='id identifier rubyid_event'>event</span> <span class='symbol'>:fail</span> <span class='kw'>do</span>
        <span class='id identifier rubyid_transitions'>transitions</span> <span class='label'>to:</span> <span class='symbol'>:failed</span><span class='comma'>,</span> <span class='label'>from:</span> <span class='lbracket'>[</span><span class='symbol'>:qc_in_progress</span><span class='comma'>,</span> <span class='symbol'>:pending</span><span class='rbracket'>]</span>
      <span class='kw'>end</span>

      <span class='id identifier rubyid_event'>event</span> <span class='symbol'>:use</span> <span class='kw'>do</span>
        <span class='id identifier rubyid_transitions'>transitions</span> <span class='label'>to:</span> <span class='symbol'>:exhausted</span><span class='comma'>,</span> <span class='label'>from:</span> <span class='lbracket'>[</span><span class='symbol'>:available</span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='label'>allow_automated?:</span> <span class='kw'>true</span>
      <span class='kw'>end</span>
    <span class='kw'>end</span>

    <span class='comment'># new version of combinable named_scope
</span>   <span class='id identifier rubyid_scope'>scope</span> <span class='symbol'>:for_state</span><span class='comma'>,</span> <span class='tlambda'>-&gt;</span><span class='lparen'>(</span><span class='id identifier rubyid_state'>state</span><span class='rparen'>)</span> <span class='tlambeg'>{</span> <span class='id identifier rubyid_where'>where</span><span class='lparen'>(</span><span class='label'>state:</span> <span class='id identifier rubyid_state'>state</span><span class='rparen'>)</span> <span class='rbrace'>}</span>

   <span class='id identifier rubyid_scope'>scope</span> <span class='symbol'>:available</span><span class='comma'>,</span>   <span class='tlambda'>-&gt;</span> <span class='tlambeg'>{</span> <span class='id identifier rubyid_where'>where</span><span class='lparen'>(</span><span class='label'>state:</span> <span class='symbol'>:available</span><span class='rparen'>)</span> <span class='rbrace'>}</span>
   <span class='id identifier rubyid_scope'>scope</span> <span class='symbol'>:unavailable</span><span class='comma'>,</span> <span class='tlambda'>-&gt;</span> <span class='tlambeg'>{</span> <span class='id identifier rubyid_where'>where</span><span class='lparen'>(</span><span class='label'>state:</span> <span class='lbracket'>[</span><span class='symbol'>:created</span><span class='comma'>,</span> <span class='symbol'>:pending</span><span class='comma'>,</span> <span class='symbol'>:failed</span><span class='comma'>,</span> <span class='symbol'>:passed</span><span class='comma'>,</span> <span class='symbol'>:destroyed</span><span class='comma'>,</span> <span class='symbol'>:qc_in_progress</span><span class='comma'>,</span> <span class='symbol'>:exhausted</span><span class='rbracket'>]</span><span class='rparen'>)</span> <span class='rbrace'>}</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

  <div id="instance_method_details" class="method_details_list">
    <h2>Instance Method Details</h2>

    
      <div class="method_details first">
  <h3 class="signature first" id="default_state-instance_method">
  
    #<strong>default_state</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


86
87
88
89
90</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/qcable/statemachine.rb', line 86</span>

<span class='kw'>def</span> <span class='id identifier rubyid_default_state'>default_state</span>
  <span class='comment'># We validate the presence of lot, however initial state gets called BEFORE we reach validation
</span>  <span class='kw'>return</span> <span class='symbol'>:created</span> <span class='kw'>if</span> <span class='id identifier rubyid_lot'>lot</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span>
  <span class='id identifier rubyid_asset_purpose'>asset_purpose</span><span class='period'>.</span><span class='id identifier rubyid_default_state'>default_state</span><span class='period'>.</span><span class='id identifier rubyid_to_sym'>to_sym</span> <span class='op'>||</span> <span class='symbol'>:created</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="on_destroyed-instance_method">
  
    #<strong>on_destroyed</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


98</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/qcable/statemachine.rb', line 98</span>

<span class='kw'>def</span> <span class='id identifier rubyid_on_destroyed'>on_destroyed</span><span class='semicolon'>;</span> <span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="on_failed-instance_method">
  
    #<strong>on_failed</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


92</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/qcable/statemachine.rb', line 92</span>

<span class='kw'>def</span> <span class='id identifier rubyid_on_failed'>on_failed</span><span class='semicolon'>;</span> <span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="on_passed-instance_method">
  
    #<strong>on_passed</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


94</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/qcable/statemachine.rb', line 94</span>

<span class='kw'>def</span> <span class='id identifier rubyid_on_passed'>on_passed</span><span class='semicolon'>;</span> <span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="on_qc-instance_method">
  
    #<strong>on_qc</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


100</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/qcable/statemachine.rb', line 100</span>

<span class='kw'>def</span> <span class='id identifier rubyid_on_qc'>on_qc</span><span class='semicolon'>;</span> <span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="on_released-instance_method">
  
    #<strong>on_released</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


96</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/qcable/statemachine.rb', line 96</span>

<span class='kw'>def</span> <span class='id identifier rubyid_on_released'>on_released</span><span class='semicolon'>;</span> <span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="on_stamp-instance_method">
  
    #<strong>on_stamp</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>â€“ These are the callbacks that will be made on entry to a given state. 
This allows derived classes to override these and add custom behaviour. 
You are advised to call super in any method that you override so that they
can be stacked. ++</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


82
83
84</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/qcable/statemachine.rb', line 82</span>

<span class='kw'>def</span> <span class='id identifier rubyid_on_stamp'>on_stamp</span>
  <span class='id identifier rubyid_lot'>lot</span><span class='period'>.</span><span class='id identifier rubyid_template'>template</span><span class='period'>.</span><span class='id identifier rubyid_stamp_to'>stamp_to</span><span class='lparen'>(</span><span class='id identifier rubyid_asset'>asset</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="on_used-instance_method">
  
    #<strong>on_used</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


102</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/qcable/statemachine.rb', line 102</span>

<span class='kw'>def</span> <span class='id identifier rubyid_on_used'>on_used</span><span class='semicolon'>;</span> <span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="transition_to-instance_method">
  
    #<strong>transition_to</strong>(target_state)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


104
105
106</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/qcable/statemachine.rb', line 104</span>

<span class='kw'>def</span> <span class='id identifier rubyid_transition_to'>transition_to</span><span class='lparen'>(</span><span class='id identifier rubyid_target_state'>target_state</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_send'>send</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_class'>class</span><span class='period'>.</span><span class='id identifier rubyid_suggested_transition_between'>suggested_transition_between</span><span class='lparen'>(</span><span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_state'>state</span><span class='comma'>,</span> <span class='id identifier rubyid_target_state'>target_state</span><span class='rparen'>)</span><span class='embexpr_end'>}</span><span class='tstring_content'>!</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

</div>

      <div id="footer">
  Generated on Mon Dec 19 11:16:27 2016 by
  <a href="http://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>
  0.9.5 (ruby-2.3.3).
</div>

    </div>
  </body>
</html>